<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
    <script>
        (function(window){

        var Cronometro = Cronometro || {
        	default : {}
        };

        Cronometro.cronometro = function(options) {

            var dataInicial	= options.dataInicial,				
                dataFinal	= options.dataFinal,
                onTick		= options.onTick,
                onComplete	= options.onComplete,
                dias 		= options.dias ? options.dias : false,
                centesimos 	= options.centesimos ? options.centesimos : false,
                intervalo 	= 0,
                that		= this;

            var init = function() {					

                var tick;

                if (!dias && !centesimos) {
                    tick = Cronometro.default.tipos.NORMAL;
                } else if (!dias && centesimos) {
                    tick = Cronometro.default.tipos.NORMAL_CENTESIMOS;
                } else if (dias && !centesimos) {
                    tick = Cronometro.default.tipos.DIAS;
                } else if (dias && centesimos) {
                    tick = Cronometro.default.tipos.DIAS_CENTESIMOS;
                }

                intervalo = setInterval(function() {
                    tick();
                },Cronometro.default.velocidade[centesimos ? 1 : 0]);  

                tick();     	
            }

            var NORMAL = function() {

                var hor, min, seg, diferenca;

                diferenca = dataFinal - dataInicial.setTime(dataInicial.getTime() + Cronometro.default.velocidade[0]);				

                if(diferenca > 0) {
                    seg = Math.floor(diferenca/1000)%60;				
                    min = Math.floor((diferenca/1000)/60)%60;			
                    hor = Math.floor(((diferenca/1000)/60)/60);

                    onTick.apply(that,[{                        
                        hor : hor,
                        min : min,
                        seg : seg
                    }]);

                } else {
                    onComplete.apply(that);
                    clearInterval(intervalo);
                }	
            }

            var DIAS = function() {
                var dia, hor, min, seg, diferenca;

                diferenca = dataFinal - dataInicial.setTime(dataInicial.getTime() + Cronometro.default.velocidade[0]);				

                if(diferenca > 0) {						
                    seg = Math.floor(diferenca/1000)%60;
                    min = Math.floor((diferenca/1000)/60)%60;
                    hor = Math.floor(((diferenca/1000)/60)/60)%24;		
                    dia = Math.floor((((diferenca/1000)/60)/60)/24);

                    onTick.apply(that,[{ 
                        dia : dia,                       
                        hor : hor,
                        min : min,
                        seg : seg
                    }]);
                } else {
                    onComplete.apply(that);
                    clearInterval(intervalo);
                }	
            };         

            Cronometro.default = {
	            tipos : {
	                NORMAL            : NORMAL,
	                DIAS              : DIAS,
	                NORMAL_CENTESIMOS : null,
	                DIAS_CENTESIMOS   : null
	            },
	            velocidade : {
	                0 : 999,
	                1 : 25
	            }
	        };

            init();            
        };
			
			/*
			Cronometro.cronometro.prototype.NORMAL_CENTESIMOS = function() {
				var hor, min, seg, cet, diferenca;

				diferenca = this.dataFinal - this.dataInicial.setTime(this.dataInicial.getTime() + Cronometro.velocidade[1]);				

				if(diferenca > 0) {
					dec = Math.floor(diferenca/10)%100;
					seg = Math.floor(diferenca/1000)%60;				
					min = Math.floor((diferenca/1000)/60)%60;			
					hor = Math.floor(((diferenca/1000)/60)/60);

					this.callback({						
						hor : hor,
						min : min,
						seg : seg,
						dec : dec
					});
				} else {
					clearInterval(this.intervalo);
				}	
			};

			

			Cronometro.cronometro.prototype.DIAS_CENTESIMOS = function() {
				var dia, hor, min, seg, diferenca;

				diferenca = this.dataFinal - this.dataInicial.setTime(this.dataInicial.getTime() + Cronometro.velocidade[1]);				

				if(diferenca > 0) {	
					dec = Math.floor(diferenca/10)%100;					
					seg = Math.floor(diferenca/1000)%60;
					min = Math.floor((diferenca/1000)/60)%60;
					hor = Math.floor(((diferenca/1000)/60)/60)%24;		
					dia = Math.floor((((diferenca/1000)/60)/60)/24);

					this.callback({
						dia : dia,
						hor : hor,
						min : min,
						seg : seg,
						dec : dec
					});
				} else {
					clearInterval(this.intervalo);
				}	
			};
			*/

            window.Cronometro = Cronometro.cronometro;

        })(window);		
    </script>	

	<p><span id="dia">00</span> dias <span id="hor">00</span> : <span id="min">00</span> : <span id="seg">00</span> : <span id="dec">00</span></p>
	<p><span id="hor2">00</span> : <span id="min2">00</span> : <span id="seg2">00</span></p>

	<script>		
		new Cronometro({
			dataInicial : new Date(),
			dataFinal 	: new Date('2012/06/27 21:40:48'),
			dias		: true,
			onTick		: function(data) {
				document.getElementById('dia').innerHTML = data.dia >= 10 ? data.dia : '0'+data.dia;
				document.getElementById('hor2').innerHTML = data.hor >= 10 ? data.hor : '0'+data.hor;
				document.getElementById('min2').innerHTML = data.min >= 10 ? data.min : '0'+data.min;
				document.getElementById('seg2').innerHTML = data.seg >= 10 ? data.seg : '0'+data.seg;				
			},
			onComplete : function() {
				console.log(this)
			}
		});				
	</script>
</body>
</html>